<!-- Generated by SpecStory -->

# How to delete columns in a DataFrame (2025-06-12 17:35:41)

_**User**_

how to delete columns in df

---

_**Assistant**_



---

Вот несколько способов удаления колонок в pandas DataFrame:

## 1. Метод `drop()`

```python
# Удалить одну колонку
df = df.drop('column_name', axis=1)

# Удалить несколько колонок
df = df.drop(['column1', 'column2', 'column3'], axis=1)

# Удалить колонки на месте (изменить исходный DataFrame)
df.drop('column_name', axis=1, inplace=True)
```

## 2. Использование `del`

```python
# Удалить одну колонку
del df['column_name']
```

## 3. Метод `pop()`

```python
# Удалить колонку и получить её значения
removed_column = df.pop('column_name')
```

## 4. Выбор нужных колонок

```python
# Оставить только нужные колонки
df = df[['column1', 'column2', 'column3']]

# Исключить ненужные колонки
columns_to_keep = [col for col in df.columns if col not in ['unwanted1', 'unwanted2']]
df = df[columns_to_keep]
```

## 5. Удаление по индексу колонки

```python
# Удалить колонку по позиции
df = df.drop(df.columns[0], axis=1)  # удалить первую колонку

# Удалить несколько колонок по позициям
df = df.drop(df.columns[[0, 2, 4]], axis=1)  # удалить 1-ю, 3-ю и 5-ю колонки
```

## 6. Удаление колонок с определенным паттерном

```python
# Удалить колонки, содержащие определенный текст
columns_to_drop = [col for col in df.columns if 'Unnamed' in col]
df = df.drop(columns_to_drop, axis=1)

# Или используя filter
df = df.loc[:, ~df.columns.str.contains('Unnamed')]
```

**Для вашего случая** с колонками типа "Unnamed: X_level_0", вы можете использовать:

```python
# Удалить все колонки с "Unnamed" в названии
df = df.loc[:, ~df.columns.str.contains('Unnamed')]

# Или явно указать колонки для удаления
columns_to_drop = [col for col in df.columns if col.startswith('Unnamed')]
df = df.drop(columns_to_drop, axis=1)
```

**Примечание:** Параметр `axis=1` указывает, что удаляются колонки (а не строки).

---

_**User**_

pd.concat

---

_**Assistant**_



---

Функция `pd.concat()` используется для объединения нескольких pandas DataFrame или Series. Вот основные способы её применения:

## 1. Базовый синтаксис

```python
import pandas as pd

# Объединение по вертикали (строки)
result = pd.concat([df1, df2, df3])

# Объединение по горизонтали (колонки)
result = pd.concat([df1, df2], axis=1)
```

## 2. Параметры функции

### `axis` - направление объединения
```python
# axis=0 (по умолчанию) - объединение по строкам (вертикально)
df_vertical = pd.concat([df1, df2], axis=0)

# axis=1 - объединение по колонкам (горизонтально)
df_horizontal = pd.concat([df1, df2], axis=1)
```

### `ignore_index` - сброс индексов
```python
# Сбросить индексы и создать новые
df_concat = pd.concat([df1, df2], ignore_index=True)
```

### `keys` - добавление иерархического индекса
```python
# Добавить метки для идентификации источника данных
df_concat = pd.concat([df1, df2], keys=['first', 'second'])
```

### `join` - тип объединения
```python
# 'outer' (по умолчанию) - сохранить все колонки
df_outer = pd.concat([df1, df2], join='outer')

# 'inner' - сохранить только общие колонки
df_inner = pd.concat([df1, df2], join='inner')
```

## 3. Практические примеры

### Объединение DataFrame'ов с одинаковыми колонками
```python
df1 = pd.DataFrame({'A': [1, 2], 'B': [3, 4]})
df2 = pd.DataFrame({'A': [5, 6], 'B': [7, 8]})

# Вертикальное объединение
result = pd.concat([df1, df2])
print(result)
#    A  B
# 0  1  3
# 1  2  4
# 0  5  7
# 1  6  8

# С сбросом индекса
result = pd.concat([df1, df2], ignore_index=True)
print(result)
#    A  B
# 0  1  3
# 1  2  4
# 2  5  7
# 3  6  8
```

### Объединение DataFrame'ов с разными колонками
```python
df1 = pd.DataFrame({'A': [1, 2], 'B': [3, 4]})
df2 = pd.DataFrame({'B': [5, 6], 'C': [7, 8]})

# Outer join (по умолчанию)
result = pd.concat([df1, df2])
print(result)
#      A    B    C
# 0  1.0    3  NaN
# 1  2.0    4  NaN
# 0  NaN    5  7.0
# 1  NaN    6  8.0

# Inner join
result = pd.concat([df1, df2], join='inner')
print(result)
#    B
# 0  3
# 1  4
# 0  5
# 1  6
```

### Горизонтальное объединение
```python
df1 = pd.DataFrame({'A': [1, 2], 'B': [3, 4]})
df2 = pd.DataFrame({'C': [5, 6], 'D': [7, 8]})

result = pd.concat([df1, df2], axis=1)
print(result)
#    A  B  C  D
# 0  1  3  5  7
# 1  2  4  6  8
```

### Объединение с метками
```python
df1 = pd.DataFrame({'value': [1, 2]})
df2 = pd.DataFrame({'value': [3, 4]})

result = pd.concat([df1, df2], keys=['group1', 'group2'])
print(result)
#          value
# group1 0     1
#        1     2
# group2 0     3
#        1     4
```

## 4. Объединение множества DataFrame'ов

```python
# Список DataFrame'ов
dataframes = [df1, df2, df3, df4]

# Объединить все сразу
result = pd.concat(dataframes, ignore_index=True)

# С метками
result = pd.concat(dataframes, keys=['df1', 'df2', 'df3', 'df4'])
```

## 5. Работа с Series

```python
s1 = pd.Series([1, 2], name='A')
s2 = pd.Series([3, 4], name='B')

# Объединение Series в DataFrame
df = pd.concat([s1, s2], axis=1)
print(df)
#    A  B
# 0  1  3
# 1  2  4
```

## 6. Полезные параметры

```python
# Проверка на совпадение индексов и колонок
result = pd.concat([df1, df2], verify_integrity=True)

# Сортировка колонок
result = pd.concat([df1, df2], sort=True)

# Копирование данных
result = pd.concat([df1, df2], copy=False)
```

**Основные отличия от других методов объединения:**
- `pd.concat()` - простое "склеивание" данных
- `pd.merge()` - объединение по ключам (как SQL JOIN)
- `df.append()` - устаревший метод, лучше использовать `concat()`

---

